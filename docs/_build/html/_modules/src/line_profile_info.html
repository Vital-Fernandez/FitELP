

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>src.line_profile_info &mdash; EmissionLineAnalysis  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> EmissionLineAnalysis
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../example.html">Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">EmissionLineAnalysis</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>src.line_profile_info</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for src.line_profile_info</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">OrderedDict</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">inf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>


<div class="viewcode-block" id="RegionParameters"><a class="viewcode-back" href="../../api.html#src.line_profile_info.RegionParameters">[docs]</a><span class="k">class</span> <span class="nc">RegionParameters</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">region_name</span><span class="p">,</span> <span class="n">blue_spec_file</span><span class="p">,</span> <span class="n">red_spec_file</span><span class="p">,</span> <span class="n">blue_spec_error_file</span><span class="p">,</span> <span class="n">red_spec_error_file</span><span class="p">,</span> <span class="n">scale_flux</span><span class="p">,</span>
                 <span class="n">center_list</span><span class="p">,</span> <span class="n">sigma_list</span><span class="p">,</span> <span class="n">lin_slope</span><span class="p">,</span> <span class="n">lin_int</span><span class="p">,</span> <span class="n">num_comps</span><span class="p">,</span> <span class="n">component_labels</span><span class="p">,</span> <span class="n">component_colors</span><span class="p">,</span>
                 <span class="n">sigma_instr_blue</span><span class="p">,</span> <span class="n">sigma_inst_red</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">em_lines_for_avg_vel_calc</span><span class="p">,</span> <span class="n">plotting_x_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">plot_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">show_systemic_velocity</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">systemic_velocity</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; List information about a region containing multiple emission lines</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        region_name : str</span>
<span class="sd">            Name of galaxy region. Do not use underscores in name, as this may affect latex compiling.</span>
<span class="sd">        blue_spec_file : str</span>
<span class="sd">            FITS file path of the blue spectrum</span>
<span class="sd">        red_spec_file : str</span>
<span class="sd">            FITS file path of the red spectrum</span>
<span class="sd">        blue_spec_error_file : str</span>
<span class="sd">            FITS file path of the blue spectrum error</span>
<span class="sd">        red_spec_error_file : str</span>
<span class="sd">            FITS file path of the red spectrum</span>
<span class="sd">        scale_flux : float</span>
<span class="sd">            scales the fluxes from the files by this factor during fitting.</span>
<span class="sd">            If scale_flux is not 1e14, then you will need to edit the string _FLUX_UNITS_WAVE constant in constants.py</span>
<span class="sd">            to reflect the scaling so that the axis labels and tables are correct.</span>
<span class="sd">        center_list : dict</span>
<span class="sd">            The center values of the gaussians for the low (H-Alpha) and high (OIII) zones of each gaussian.</span>
<span class="sd">            E.g. centerList = {&#39;low&#39;: [3918.56, 3969.72, 3978.93], &#39;high&#39;: [3923.50, 3970.63, 3984.13]}</span>
<span class="sd">        sigma_list : dict</span>
<span class="sd">            The sigma values of the gaussians for the low (H-Alpha) and high (OIII) zones of each gaussian.</span>
<span class="sd">            E.g. sigmaList = {&#39;low&#39;: [17.123, 13.868, 45.207],&#39;high&#39;: [15.740, 12.875, 43.667]}</span>
<span class="sd">        lin_slope : dict</span>
<span class="sd">            The linear slope values representing the continuum for the low (H-Alpha) and high (OIII) zones.</span>
<span class="sd">            E.g. lin_slope = {&#39;low&#39;: -5.2237e-08, &#39;high&#39;: -2.8976e-07}</span>
<span class="sd">        lin_int : dict</span>
<span class="sd">            The linear intercept values representing the continuum for the low (H-Alpha) and high (OIII) zones.</span>
<span class="sd">            E.g. lin_int = {&#39;low&#39;: 0.00139680, &#39;high&#39;: 0.00254310}</span>
<span class="sd">        num_comps : dict</span>
<span class="sd">            The number of components for the low (H-Alpha) and high (OIII).</span>
<span class="sd">            This should be the length of the lists of the center and sigma of each of the guassian components</span>
<span class="sd">            E.g. num_comps = {&#39;low&#39;: 3, &#39;high&#39;: 3}</span>
<span class="sd">        component_labels : list</span>
<span class="sd">            Labels for each of the components in the order that they are presented in all other lists.</span>
<span class="sd">            E.g. component_labels = [&#39;Narrow 1&#39;, &#39;Narrow 2&#39;, &#39;Broad&#39;]</span>
<span class="sd">        component_colors : list</span>
<span class="sd">            Colour to plot each of the components in the order that they appear in component_labels.</span>
<span class="sd">            E.g. componentColours = [&#39;r&#39;, &#39;c&#39;, &#39;g&#39;]</span>
<span class="sd">        sigma_instr_blue : float</span>
<span class="sd">            The instrument sigma in the blue arm.</span>
<span class="sd">        sigma_inst_red : float</span>
<span class="sd">            The instrument sigma in the blue arm.</span>
<span class="sd">        distance : float</span>
<span class="sd">            The distance to the region in centimetres (same units that distance appears in the input flux)</span>
<span class="sd">        em_lines_for_avg_vel_calc : list</span>
<span class="sd">            The emission lines to use to calculate the average velocity.</span>
<span class="sd">            E.g. emLinesForAvgVelCalc = [&#39;H-Alpha&#39;, &#39;H-Beta&#39;, &#39;OIII-5007A&#39;, &#39;NII-6584A&#39;, &#39;SII-6717A&#39;]</span>
<span class="sd">        plotting_x_range: list or None</span>
<span class="sd">            The wavelength (or velocity) range to plot each of the emission line gaussians.</span>
<span class="sd">            E.g. plotting_x_range = [3600, 4400]</span>
<span class="sd">        plot_residuals : bool</span>
<span class="sd">            Whether to plot the residuals of the fit in an extra panel below the gaussian</span>
<span class="sd">            Default is True.</span>
<span class="sd">        show_systemic_velocity : bool</span>
<span class="sd">            Assumed False if it is not defined. If True, the xAxis is plotted</span>
<span class="sd">            as the measured velocity minus the systemicVelocity: (velocity - systemicVelocity)</span>
<span class="sd">        systemic_velocity : float or None</span>
<span class="sd">            Required if show_systemic_velocity is True.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">regionName</span> <span class="o">=</span> <span class="n">region_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">blueSpecFile</span> <span class="o">=</span> <span class="n">blue_spec_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">blueSpecError</span> <span class="o">=</span> <span class="n">blue_spec_error_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">redSpecFile</span> <span class="o">=</span> <span class="n">red_spec_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">redSpecError</span> <span class="o">=</span> <span class="n">red_spec_error_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scaleFlux</span> <span class="o">=</span> <span class="n">scale_flux</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">centerList</span> <span class="o">=</span> <span class="n">center_list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigmaList</span> <span class="o">=</span> <span class="n">sigma_list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linSlope</span> <span class="o">=</span> <span class="n">lin_slope</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linInt</span> <span class="o">=</span> <span class="n">lin_int</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">numComps</span> <span class="o">=</span> <span class="n">num_comps</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">componentLabels</span> <span class="o">=</span> <span class="n">component_labels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">componentColours</span> <span class="o">=</span> <span class="n">component_colors</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plottingXRange</span> <span class="o">=</span> <span class="n">plotting_x_range</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigmaInstrBlue</span> <span class="o">=</span> <span class="n">sigma_instr_blue</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigmaInstrRed</span> <span class="o">=</span> <span class="n">sigma_inst_red</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">distance</span> <span class="o">=</span> <span class="n">distance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">emLinesForAvgVelCalc</span> <span class="o">=</span> <span class="n">em_lines_for_avg_vel_calc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotResiduals</span> <span class="o">=</span> <span class="n">plot_residuals</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showSystemicVelocity</span> <span class="o">=</span> <span class="n">show_systemic_velocity</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">systemicVelocity</span> <span class="o">=</span> <span class="n">systemic_velocity</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">emProfiles</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>

<div class="viewcode-block" id="RegionParameters.add_em_line"><a class="viewcode-back" href="../../api.html#src.line_profile_info.RegionParameters.add_em_line">[docs]</a>    <span class="k">def</span> <span class="nf">add_em_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">plot_color</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="nb">filter</span><span class="p">,</span> <span class="n">min_idx</span><span class="p">,</span> <span class="n">max_idx</span><span class="p">,</span> <span class="n">rest_wavelength</span><span class="p">,</span> <span class="n">amp_list</span><span class="p">,</span> <span class="n">zone</span><span class="p">,</span> <span class="n">sigma_tsquared</span><span class="p">,</span> <span class="n">comp_limits</span><span class="p">,</span> <span class="n">copy_from</span><span class="p">,</span> <span class="n">num_comps</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Emission line info</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            Name of emission line. E.g. &#39;H-Alpha&#39; or NII-6584A. This name must be in the appropriate format.</span>
<span class="sd">        plot_color : str</span>
<span class="sd">            The color that this emission line should appear in each of the plots.</span>
<span class="sd">        order : int</span>
<span class="sd">            The order that this emission line appears in the Echelee FITS files.</span>
<span class="sd">        filter : str</span>
<span class="sd">            &#39;red&#39; or &#39;blue&#39;. Indicating the filter that this emission line appears in the echelle spectra.</span>
<span class="sd">        min_idx : int</span>
<span class="sd">            Minimum index of the region in the echelle spectra that includes this emission line.</span>
<span class="sd">        max_idx : int</span>
<span class="sd">            Maximum index of the region in the echelle spectra that includes this emission line.</span>
<span class="sd">        rest_wavelength : float</span>
<span class="sd">            The rest wavelength of this emission line.</span>
<span class="sd">        num_comps : int (optional)</span>
<span class="sd">            The number of Gaussian components to fit the emission line.</span>
<span class="sd">            This overrides the num_comps set in RegionParameters for this emission line only.</span>
<span class="sd">        amp_list: list or float</span>
<span class="sd">            The list of amplitudes for each of the components that are included.</span>
<span class="sd">            This must be a list with the same number of elements as &#39;num_comps&#39;.</span>
<span class="sd">            If this is a float, then the amplitudes from the emission line listed in the copy_from parameter will be</span>
<span class="sd">            used and divided by this value.</span>
<span class="sd">        zone : str</span>
<span class="sd">            &#39;low&#39; or &#39;high&#39;.</span>
<span class="sd">        sigma_tsquared : float</span>
<span class="sd">            sigma of the temperature squared</span>
<span class="sd">        comp_limits : dict</span>
<span class="sd">            The limits in &#39;compLimits&#39; can be in the following forms:</span>
<span class="sd">            - a list indicating the limits for each component</span>
<span class="sd">            - a single number indicating the percentage limits for ALL components</span>
<span class="sd">            - a tuple (minValue, maxValue) indicating the min and max not in a percentage</span>
<span class="sd">            - inf: indicating that the component can vary</span>
<span class="sd">            - False: indicating that the value is fixed</span>
<span class="sd">        copy_from : str or None or list</span>
<span class="sd">            The name of the emission line to copy from. If None, it will not copy any information.</span>
<span class="sd">            If it is a list, it must be the length of the number of components you have (as defined in num_comps in</span>
<span class="sd">            RegionParameters). Each element of the list must be a string indicating which emission line to</span>
<span class="sd">            copy for each component.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">emProfiles</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Colour&#39;</span><span class="p">:</span> <span class="n">plot_color</span><span class="p">,</span> <span class="s1">&#39;Order&#39;</span><span class="p">:</span> <span class="n">order</span><span class="p">,</span> <span class="s1">&#39;Filter&#39;</span><span class="p">:</span> <span class="nb">filter</span><span class="p">,</span>
                                 <span class="s1">&#39;minI&#39;</span><span class="p">:</span> <span class="n">min_idx</span><span class="p">,</span> <span class="s1">&#39;maxI&#39;</span><span class="p">:</span> <span class="n">max_idx</span><span class="p">,</span> <span class="s1">&#39;restWavelength&#39;</span><span class="p">:</span> <span class="n">rest_wavelength</span><span class="p">,</span>
                                 <span class="s1">&#39;numComps&#39;</span><span class="p">:</span> <span class="n">num_comps</span><span class="p">,</span> <span class="s1">&#39;ampList&#39;</span><span class="p">:</span> <span class="n">amp_list</span><span class="p">,</span> <span class="s1">&#39;zone&#39;</span><span class="p">:</span> <span class="n">zone</span><span class="p">,</span>
                                 <span class="s1">&#39;sigmaT2&#39;</span><span class="p">:</span> <span class="n">sigma_tsquared</span><span class="p">,</span> <span class="s1">&#39;compLimits&#39;</span><span class="p">:</span> <span class="n">comp_limits</span><span class="p">,</span> <span class="s1">&#39;copyFrom&#39;</span><span class="p">:</span> <span class="n">copy_from</span><span class="p">}</span></div></div>


</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Daniel Muthukrishna

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>